{% extends "base.html" %}

{% block content %}
  <h2> Изменить аватарку </h2>
  <img id="avatar-preview" width='128' height='128'>
  <form action="{{ url_for('change_avatar') }}" method="post" enctype="multipart/form-data">
    <input type="file" accept="image/png,image/jpg" id="load-avatar" name="avatar">
    <button type="submit"> "Подтрвердить" </button>
  </form>
  <script type="text/javascript">
    function handleFileSelect(e) {
      var file = e.target.files[0];

      if (!file.type.match('image.*')) {
        alert('Автатарка - это картинка. Загрузите картинку.');
      }

      var reader = new FileReader();

      reader.onload = (function(theFile) {
        return function(e) {
          var img = document.getElementById('avatar-preview');
          img.setAttribute('src', e.target.result);
        }
      })(file);
      reader.readAsDataURL(file);
    }

    document.getElementById('load-avatar').addEventListener('change', handleFileSelect)
  </script>
{% endblock %}
